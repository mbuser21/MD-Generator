<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Banner Generator Preview</title>
    <!-- Library for converting HTML to image for download --><script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Reverting to Tinos font for a classic, professional look --><link href="https://fonts.googleapis.com/css2?family=Tinos:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* CSS Variables based on user request */
        :root {
            --theme-color: #73A441; /* Primary Green */
            --dark-green: #3D5523; /* Dark accent for name/contact bar */
            --light-bg: #EAEAEF;
            --text-color-dark: #333;
            --text-color-light: #f7f7f7;
            --text-color-specialty: #D03D3D; /* Red color for specialties */
        }

        body {
            font-family: 'Tinos', serif;
            background-color: var(--light-bg);
            /* Centering the entire content */
            display: flex;
            justify-content: center;
            align-items: flex-start;
            flex-wrap: wrap; 
            padding: 20px;
        }

        /* --- Controls (Input Form) Styling - FIXED WIDTH --- */
        #controls {
            width: 800px; /* Adjusted Fixed width to match new banner width (800px) */
            min-width: 800px; 
            padding: 30px; 
            background-color: white;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); 
            border-radius: 16px; 
            margin-bottom: 30px; 
        }

        /* Header for title and clear button */
        .controls-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px; 
        }

        #controls h2 {
            margin: 0; /* Remove default margin from h2 inside header */
        }

        /* Enable Grid Layout for the form */
        #bannerForm {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* Two equal columns */
            gap: 20px 30px; /* Row gap and Column gap */
        }

        /* Full width elements span both columns */
        .form-group.full-width,
        #controls button {
            grid-column: 1 / -1;
        }

        .form-group {
            margin: 0; /* Resetting default margin */
        }

        /* Styling for Labels */
        #controls label {
            display: block;
            width: 100%;
            margin-bottom: 6px; 
            margin-top: 0; /* Removed top margin, controlled by grid gap */
            font-weight: 700; 
            color: var(--dark-green);
            font-size: 0.95em;
        }

        /* Styling for Inputs and Textareas */
        #controls input, #controls textarea {
            display: block;
            width: 100%;
            margin-bottom: 0; /* Controlled by grid gap */
            box-sizing: border-box;
            border-radius: 8px; 
            border: 1px solid #ccc;
            padding: 12px 15px; 
            transition: all 0.2s ease-in-out;
            font-size: 1em;
            color: var(--text-color-dark);
        }
        
        /* Focus effect for inputs */
        #controls input:focus, #controls textarea:focus {
            outline: none;
            border-color: var(--theme-color);
            box-shadow: 0 0 0 3px rgba(115, 164, 65, 0.3); 
        }

        #controls textarea { 
            height: 90px; 
            resize: vertical; 
        } 
        
        /* Button Styling */
        #controls button {
            display: block;
            width: 100%;
            box-sizing: border-box;
            border-radius: 8px;
            color: white;
            padding: 14px; 
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            margin-top: 0; /* Reset, controlled by grid gap */
        }
        
        /* Generate Button (Primary) */
        #controls button:first-of-type { 
            background-color: var(--theme-color);
            margin-top: 10px; /* Slight extra margin above buttons */
        }

        /* Download Button (Secondary, Darker Green) */
        #controls button:nth-of-type(2) { 
            background-color: var(--dark-green);
            /* margin-top is handled by grid gap (20px) */
        }

        #controls button:hover {
            opacity: 0.95;
            transform: translateY(-1px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.25);
        }

        /* Special alignment for buttons row (make buttons align horizontally) */
        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0 30px;
            grid-column: 1 / -1; /* Ensure this group spans full width */
            margin-top: 10px;
        }
        .button-group button {
            margin-top: 0 !important;
        }

        /* --- Banner Container and Layout - FIXED DIMENSIONS --- */
        #banner-container {
            width: 800px; /* Reduced Fixed width */
            height: 508px; /* Reduced Fixed height */
            max-width: none; 
            aspect-ratio: auto; 
            box-shadow: 0 0 25px rgba(0,0,0,0.4);
            border-radius: 8px;
            overflow: hidden;
        }

        #medical-banner {
            width: 100%;
            height: 100%;
            background-color: white;
            position: relative;
            color: var(--text-color-dark);
            padding: 0;
            box-sizing: border-box;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cdefs%3E%3Cpattern id='diagonal-lines' width='10' height='10' patternUnits='userSpaceOnUse' patternTransform='rotate(45)'%3E%3Cline x1='0' y1='0' x2='0' y2='10' stroke='%23f7f7f7' stroke-width='1' /%3E%3C/pattern%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='url(%23diagonal-lines)'/%3E%3C/svg%3E");
        }

        /* --- Right Background Zone (20% width of 800px = 160px) --- */
        .right-green-zone {
            position: absolute;
            top: 0;
            right: 0;
            width: 20%; 
            height: 100%;
            background-color: var(--theme-color);
            z-index: 5; 
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Cg fill='%23648e3d' fill-opacity='0.2'%3E%3Cpath fill-rule='evenodd' d='M0 0h40v40H0V0zm40 40h40v40H40V40z'/%3E%3C/g%3E%3C/svg%3E");
        }
        
        /* --- Top Left Section: Logo --- */
        .banner-top-left {
            position: absolute;
            top: 4%; 
            left: 4%;
            z-index: 20;
        }

        .logo-svg {
            width: 40px;
            height: 40px;
        }

        /* --- Doctor Photo - FIXED SIZE --- */
        .doctor-photo-circle {
            position: absolute;
            top: 25%; 
            left: 72%; 
            transform: translateY(-50%); 
            width: 140px; /* Slightly reduced for 800px container */
            height: 140px; /* Slightly reduced for 800px container */
            max-width: none; 
            max-height: none;
            border-radius: 50%;
            overflow: hidden;
            border: 6px solid white; 
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            background-color: var(--light-bg);
            z-index: 10; 
        }

        #outputDoctorImage {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center top; 
        }

        /* --- Specialties Section --- */
        .specialties-section {
            position: absolute;
            top: 12%; 
            left: 4%;
            width: 70%; 
            padding: 10px 0;
            z-index: 5;
        }

        #outputSpecialties {
            font-size: 24px !important; /* Slightly reduced font size */
            line-height: 1.2;
            color: var(--text-color-specialty);
            font-weight: 700;
        }

        /* --- Doctor Info Section (Name & Degrees) --- */
        .doctor-info-section {
            position: absolute;
            top: 24%; 
            left: 4%;
            width: 70%; 
            z-index: 5;
        }
        
        /* Thin separator line */
        .info-separator {
            width: 100%;
            height: 3px;
            background-color: var(--theme-color);
            margin: 10px 0 20px 0;
            border-radius: 1.5px;
        }

        #outputDoctorName {
            font-size: 30px; /* Slightly reduced font size */
            color: var(--dark-green);
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 10px; 
            text-shadow: 0.5px 0.5px 1px rgba(0, 0, 0, 0.2);
        }

        .degrees-list {
            font-size: 17px; 
            line-height: 1.7; /* Adjusted line height */
            color: var(--text-color-dark);
            padding-right: 5%; 
        }

        /* --- Contact Info Section (Full Width Bottom Bar) --- */
        .contact-info-section {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%; 
            padding: 15px 4%; /* Reduced padding */
            background-color: var(--dark-green);
            color: var(--text-color-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-sizing: border-box;
            z-index: 20;
        }

        .address-box {
            width: 65%; 
            font-size: 14px; /* Reduced font size */
            line-height: 1.4;
            border-left: 5px solid white;
            padding-left: 15px;
        }

        .contact-box {
            width: 30%; 
            text-align: right;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }
        
        .contact-label {
            font-size: 13px; /* Reduced font size */
            font-weight: 400;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 3px;
        }

        .contact-number {
            font-size: 20px; /* Reduced font size */
            font-weight: 700;
            color: var(--text-color-light);
            padding: 0 5px; 
            border-radius: 4px;
        }
    </style>
</head>
<body>

    <div id="controls">
        <div class="controls-header">
            <h2>Banner Input Form</h2>
        </div>
        <form id="bannerForm">
            
            <!-- Column 1: Doctor's Name -->
            <div class="form-group">
                <label for="doctorName">Doctor's Name:</label>
                <input type="text" id="doctorName" value="" placeholder="Doctor's Name">
            </div>

            <!-- Column 2: Contact Number -->
            <div class="form-group">
                <label for="contact">Contact Number (সিরিয়ালের জন্য):</label>
                <input type="text" id="contact" value="" placeholder="Contact Number">
            </div>

            <!-- Full Width Row: Specialties (Textarea) -->
            <div class="form-group full-width">
                <label for="specialties">Specialties (Use Enter/Newline for line breaks):</label>
                <textarea id="specialties" placeholder="Specialties"></textarea>
            </div>

            <!-- Full Width Row: Degrees & Affiliation (Textarea) -->
            <div class="form-group full-width">
                <label for="degrees">Degrees & Affiliation (Use Enter/Newline for new line):</label>
                <textarea id="degrees" placeholder="Degrees & Affiliation"></textarea>
            </div>

            <!-- Full Width Row: Address (Textarea) -->
            <div class="form-group full-width">
                <label for="address">Address (Use Enter/Newline for line breaks):</label>
                <textarea id="address" placeholder="Address"></textarea>
            </div>
            
            <!-- Column 1 (Left): Doctor Image Upload -->
            <div class="form-group">
                <label for="imageUpload">Doctor Image (Upload):</label>
                <input type="file" id="imageUpload" accept="image/*">
            </div>

            <!-- Column 2 (Right): Empty/Spacing (Left blank) -->
            <div class="form-group">
                <!-- Empty for alignment or future use -->
            </div>

            <!-- Full Width Button Group -->
            <div class="button-group">
                <button type="button" onclick="generateBanner()">Generate Banner</button>
                <button type="button" onclick="downloadBanner()">Download as PNG (High Quality)</button>
            </div>
        </form>
    </div>

    <div id="banner-container">
        <!-- The Banner Output Area --><div id="medical-banner">
            
            <!-- Right Green Zone (Background for Photo) --><div class="right-green-zone"></div>
            
            <!-- Doctor Photo (Fixed size and position) --><div class="doctor-photo-circle">
                <!-- Placeholder doctor image (Themed for better look) --><img id="outputDoctorImage" src="https://placehold.co/300x300/3D5523/FFFFFF?text=Doctor" alt="Doctor Photo">
            </div>

            <!-- Logo Section --><div class="banner-top-left">
                <div class="logo-section">
                  <img src="l.png">
                </div>
            </div>
            
            <!-- Specialties Section --><div class="specialties-section">
                <h2 id="outputSpecialties"></h2>
            </div>

            <!-- Doctor Info Section (Name & Degrees) --><div class="doctor-info-section">
                <div class="info-separator"></div>
                <h3 id="outputDoctorName"></h3>
                <div id="outputDegrees" class="degrees-list"></div>
            </div>

            <!-- Contact Info Section (Full Width Bottom Bar) --><div class="contact-info-section">
                <div class="address-box">
                    <div id="outputAddress"></div>
                </div>
                <div class="contact-box">
                    <div class="contact-label">সিরিয়ালের জন্য</div>
                    <div id="outputContact" class="contact-number"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Function to generate the banner content
        function generateBanner() {
            // Get values from the form
            const doctorName = document.getElementById('doctorName').value;
            const specialties = document.getElementById('specialties').value;
            const degrees = document.getElementById('degrees').value;
            const address = document.getElementById('address').value;
            const contact = document.getElementById('contact').value;
            const imageFile = document.getElementById('imageUpload').files[0];

            // Update the banner elements
            
            // Replace newline characters with <br> for proper HTML display, 
            // use a default value for specialties if empty to prevent empty heading tag
            document.getElementById('outputSpecialties').innerHTML = specialties ? specialties.replace(/\n/g, '<br>') : "বিশেষজ্ঞ (Specialist)";
            document.getElementById('outputDoctorName').innerHTML = doctorName ? doctorName.replace(/\n/g, '<br>') : "Doctor Name";
            document.getElementById('outputDegrees').innerHTML = degrees ? degrees.replace(/\n/g, '<br>') : "Degrees and Affiliations";
            document.getElementById('outputAddress').innerHTML = address ? address.replace(/\n/g, '<br>') : "Clinic Address, City, Post Code";
            document.getElementById('outputContact').innerText = contact || "Phone Number";

            // Handle image upload
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('outputDoctorImage').src = e.target.result;
                };
                reader.readAsDataURL(imageFile);
            } else {
                // Set a default placeholder if no image is uploaded (using themed placeholder)
                document.getElementById('outputDoctorImage').src = 'https://placehold.co/300x300/3D5523/FFFFFF?text=Doctor'; 
            }
        }

        // Function for downloading as PNG using html2canvas (reliable browser conversion)
        function downloadBanner() {
            const banner = document.getElementById('medical-banner');
            const doctorName = document.getElementById('doctorName').value.trim();
            
            // Minimal Sanitization: Only remove characters that are strictly invalid in file paths 
            // (slashes, colons, question marks, etc.) but keep all Unicode characters (Bangla) intact.
            const cleanName = doctorName.replace(/[\\/:*?"<>|]/g, '').trim(); 
            
            const fileName = (cleanName || 'medical_banner') + '.png'; 

            // Use html2canvas to render the content to a canvas
            html2canvas(banner, {
                // Increase scale for higher resolution output (e.g., 3x resolution)
                scale: 3 
            }).then(function(canvas) {
                // Convert the canvas to a PNG image data URL
                const dataUrl = canvas.toDataURL('image/png', 1.0);
                
                // Create a temporary link element for download
                const link = document.createElement('a');
                link.download = fileName; // Set the dynamic Bengali filename
                link.href = dataUrl;
                link.click();

                console.log(`Downloaded banner as ${fileName}.`);
            });
        }

        // Initial banner generation on load
        window.onload = generateBanner;
    </script>

</body>
</html>
